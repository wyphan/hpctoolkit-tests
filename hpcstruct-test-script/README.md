This directory contains two python scripts to test hpcstruct.

# collect.py
This script takes a directory as input and outputs all binaries inside the input directory to a output file. For example, running

```
python collect.py --srcdir /lib64 --out lib64.txt
```

will collect all binaries under `/lib64` (so, all system libraries) to print the full paths of these binaries to file `lib64.txt`.

One can use this script to generate a collection of binaries to test `hpcstruct` using `/lib64`, `/usr/bin`, or software packages built by spack.

# hpcstruct-test.py
This script takes a file list generated by `collect.py` and run `hpcstruct` on every binary in the file list.
Currently, the script will report any output from stdout and stderr, and detect return code from `hpcstruct` (so it can detect segfault or other crashes).

The script has the following input parameter:

```
  -h, --help           show this help message and exit
  --filelist FILELIST  a list of binary for benchmarking
  --rep REP            the number of iterations to run on each binary
  --thread THREAD      the number of threads
  --start START        From which line of the input file to test
```

`--filelist` is required and can be set to a file list generated by `collect.py`. `--rep` is 5 by default and `--thread` is 16 by default. `--start` is 1 by default, which means to do test from the first line of the file list. `--start` can be used if the testing job terminated due to time limit.

The script invokes `hpcstruct` directly, so before running the script, please ensure that `hpcstruct` is in your `$PATH`.
